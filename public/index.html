<!DOCTYPE html>
<html>
  <head>
	<link rel="stylesheet" type="text/css" href="css/styles.css">
    <title>socket.io</title>
  </head>
  <body>
  
    <!-- <img src="/images/PandaWizard.png"> -->
	<!-- <script src="javascript/script.js"></script> -->
	
    
	
	<ul id="messages"></ul>
	
	<form class="ready-form" action="">
		<div class="hero-group">
			<input type="radio" name="hero" value="warrior" checked="checked"> Warrior
			<input type="radio" name="hero" value="archer"> Archer
			<input type="radio" name="hero" value="mage"> Mage
		</div>
		<div class="hero-stats">
			<table>
				<tr>
					<th>STR</th>
					<td>
						<input class="slider" type="range" range-group="stats" name="attack" range-group-max-sum="16" min="0" max="10" value="5">
					</td>
					<td class="stat-val">5</td>
				</tr>
				<tr>
					<th>DEF</th>
					<td>
						<input class="slider" type="range" range-group="stats" name="defence" range-group-max-sum="16" min="0" max="10" value="5">
					</td>
					<td class="stat-val">5</td>
				</tr>
				<tr>
					<th>SPD</th>
					<td>
						<input class="slider" type="range" range-group="stats" name="speed" range-group-max-sum="16" min="0" max="10" value="3">
					</td>
					<td class="stat-val">3</td>
				</tr>
				<tr>
					<th>LUK</th>
					<td>
						<input class="slider" type="range" range-group="stats" name="luck" range-group-max-sum="16" min="0" max="10" value="3">
					</td>
					<td class="stat-val">3</td>
				</tr>
			</table>
			
			<form>
  <formgroup class="ranges">
    <input type="range" min="0" max="100">
    <input type="range" min="0" max="100">
    <input type="range" min="0" max="100">
    <input type="range" min="0" max="100">
  </formgroup>
</form>

		</div>		
		<input type="text" name="user_name" placeholder="Enter your name" required>
		<input type="submit" value="Ready">
	</form>
	
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="javascript/jquery.rangegroup.js" type="text/javascript"></script>
	
    <script>
		$(function () {
		var ranges = Array.from(document.querySelector('.ranges').children);

var total = ranges.reduce(function(acc, curr) {
  return acc + Number(curr.value)
}, 0)

			$("[type='range']").on("change", function() {
				console.log($(this).val());
				$(this).parent().siblings(".stat-val").text($(this).val());
				var sum = 0;
				$("[type='range']").each(function(){
					sum += +$(this).val();
					console.log(sum);
				});
			});
			var socket = io();
			$('.ready-form').submit(function(){
				var character = {
					name: $("[name='user_name']").val(),
					hero_class: $("[name='hero']:checked").val(),
					attack: $("[name='attack']").val(),
					defence: $("[name='defence']").val(),
					speed: $("[name='speed']").val(),
					luck: $("[name='luck']").val()
				};
				//socket.emit( 'player_ready', $("[name='user_name']").val() );
				socket.emit( 'player_ready', character );
				$('.ready-form').replaceWith( "<div class='ready-form'>Player " + $("[name='user_name']").val() + " is ready!</div>" );
				return false;
			});
			socket.on('ready_message', function(msg){
				//$('#messages').append($('<li>').text(msg));
				//window.scrollTo(0, document.body.scrollHeight);
			});
		});
    </script>
  </body>
</html>